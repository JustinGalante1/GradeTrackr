{% extends 'gradetracker/template.html' %}
{% block content %}
{% load static %}



        

<div id ="overlay"></div>
{% if courses_list %}
<div class="m container justify-content-center" id="main">

 <!-- new course modal-->
   <div id="addNewCourse" class="w3-modal" style="z-index: 2;">
        <div class="w3-modal-content w3-animate-top " style="border-radius: 15px;">
          <div class="card scene_element scene_element--fadein" style="width: auto; overflow: hidden;" id="beautifiedCard">
            <div class="card-body" style="padding-bottom: 1.75%;">
        
              <h3 class="card-title" style="text-align: center;"><b>
                Add a Course to Your Schedule
              </b></h3>
              <p class="card-text" style="color:black; text-align: center;">
                <form action = "{% url 'gradetracker:add' %}" method = "post">
                {% csrf_token %}
                <input type="hidden" name="included" value="True">
                <div style="padding:2%">
                <label for="courseTitle"><b>Course Name</b></label>
                <input type="text" class="form-control" id="courseTitle" name="courseTitle" required pattern=".*" placeholder="PHYS 2415">
                </div>
    
                <div style="padding:2%">
                <label for="credits"><b>Credits</b></label>
                <input class="form-control" type="number" value="3" id="credits" name="credits" min="1" max="6">
                </div>

                <div style="padding:2%">
                <label for="goal">Target Grade (out of 100)</label>
                <input type="number" class="form-control" id="goal" name="goal" required pattern="[0-9]+\.[0-9][0-9]" placeholder="Ex: 95.00" min="0.5" max="100" step="0.5">
                </div>
                
                <input type="hidden" class="submitOrCancel" id="submitOrCancel" name="submitOrCancel" value="">
                
                <div style="text-align: center;">
                <button type="submit" class="btn btn-info" style="margin-left:2%;margin-right:0.5%;margin-top:2%;background-color: rgb(27,27,27);border-style: none;border-radius: 20px;" onclick="enableEverything()"><b>ADD</b></button>
                <button type="cancel" class="btn btn-danger" style="margin-top:2%;border-radius: 20px;background-color: #ff3737;border-style: none;" onclick="document.getElementById('addNewCourse').style.display='none';document.getElementById('overlay').style.display='none';cancelEverything()"><b>CANCEL</b></button>
                </div>
    
                </form></p>
              </div></div>
        </div>
      </div>
      <!-- end new course modal-->


      <!-- new grade category modal-->

      {% for course in courses_list %}

      <div id="{{course.id}}CATEGORY" class="w3-modal" style="z-index: 2;">
        <div class="w3-modal-content w3-animate-top " style="border-radius: 15px;">
          <div class="card scene_element scene_element--fadein" style="width: auto; overflow: hidden;" id="beautifiedCard">
            <div class="card-body" style="padding-bottom: 1.75%;">
        
              <h3 class="card-title" style="text-align: center;"><b>
                Add a Grade Category to {{course.name}}
              </b></h3>
              <p class="card-text" style="color:black; text-align: center;">
                <form action = "{% url 'gradetracker:gradecat' course.id%}" method = "post">
                {% csrf_token %}
                <input type="hidden" name="included" value="True">
                <div style="padding:2%">
                <label for="name"><b>Name of Grade Category</b></label>
                <input type="text" class="form-control" id="name" name="name" required pattern=".*" placeholder="Exams">
                </div>
    
                <div style="padding:2%">
                <label for="weight">% Weightage Towards Overall Grade</label>
                <input type="number" class="form-control" id="weight"  name="weight" required pattern="[0-9]+\.[0-9][0-9]" placeholder="Ex: 15" max="100" min="1"> 
                </div>

                
                <input type="hidden" class="submitOrCancel" id="submitOrCancel" name="submitOrCancel" value="">
                
                <div style="text-align: center;">
                <button type="submit" class="btn btn-info" style="margin-left:2%;margin-right:0.5%;margin-top:2%;background-color: rgb(27,27,27);border-style: none;border-radius: 20px;" onclick="enableEverything()"><b>ADD</b></button>
                <button type="cancel" class="btn btn-danger" style="margin-top:2%;border-radius: 20px;background-color: #ff3737;border-style: none;" onclick="document.getElementById('{{course.id}}CATEGORY').style.display='none';document.getElementById('overlay').style.display='none';cancelEverything()"><b>CANCEL</b></button>
                </div>
    
                </form></p>
              </div></div>
        </div>
      </div>

      {% endfor %}

      <!-- end new grade category modal-->


    <!--<ul>-->
        <div class="cardGrid">


          <!--DASHBOARD OVERVIEW CARD-->
    <div class="card scene_element scene_element--fadein" style="width: auto; float:left" id="beautifiedCard">
      <div class="card-body" style="padding-bottom: 1.75%;">
        <h4 class="card-title"><b>At a glance<span style="float:right; color:rgb(0, 165, 27)">{{ student.cumulativeGPA.gradePercentage }} GPA</span></b></h4>
        <p class="card-text" style="color:black; text-align: left;">
          Use this space for gain/loss percent for classes, semester GPA, etc <br/>

          {% for course in courses_list %}
          {{course}}&nbsp;{{course.avgGrade}}%<br />
          {% endfor %}
          
        </p>
        <span style="color:black; float: right;"><b>{{cum}} credits being tracked</b></span>

      </div>
    </div>
    <!--END OF DASHBOARD OVERVIEW CARD-->



    {% for course in courses_list %}

    <div id="{{course.id}}ASS" class="w3-modal" style="z-index: 2;">
      <div class="w3-modal-content w3-animate-top " style="border-radius: 15px;">
        <div class="card scene_element scene_element--fadein" style="width: auto; overflow: hidden;" id="beautifiedCard">
          <div class="card-body" style="padding-bottom: 1.75%;">
      
            
      
            <h3 class="card-title" style="text-align: center;"><b>
              Add an assignment
            </b></h3>
            <p class="card-text" style="color:black; text-align: center;">
              <form action = "{% url 'gradetracker:addAssignment' course.id%}" method = "post">
              {% csrf_token %}
  
              <div style="padding:2%">
              <label for="assignmentName"><b>Name</b></label>
              <input type="text" class="form-control" id="assignmentName" name="assignmentName" required pattern=".*" placeholder="Quiz 3">
              </div>
  
              <div style="padding:2%">
              <label for="weight"><b>% Grade Earned</b></label>
              <input type="number" class="form-control" id="weight" name="weight" required pattern="[0-9]+\.+[0-9][0-9]" placeholder="Ex: 81" title="In format of XX.XX" min="1" max="100" step="0.01">
              </div>
              
              <div style="padding:2%">
              <label><b>Category it Belongs To</b></label><br/>
              {% for key, value in coursesAndTheirCategories.items %}
                {% if key == course %}
                {% for category in value %}
                    <input type="radio" name="categoryChoice" id="choice{{ forloop.counter }}" value="{{category.id}}">
                    <label for="choice{{ forloop.counter }}" >{{ category.name }}</label><br>
                {% endfor %}
                {% endif %}
              {% endfor %}
            </div>
              <input type="hidden" class="submitOrCancel" id="submitOrCancel" name="submitOrCancel" value="">
              
              <div style="text-align: center;">
              <button type="submit" class="btn btn-info" style="margin-left:2%;margin-right:0.5%;margin-top:2%;background-color: rgb(27,27,27);border-style: none;border-radius: 20px;" onclick="enableEverything()"><b>ADD</b></button>
              <button type="cancel" class="btn btn-danger" style="margin-top:2%;border-radius: 20px;background-color: #ff3737;border-style: none;" onclick="document.getElementById('{{course.id}}ASS').style.display='none';document.getElementById('overlay').style.display='none';cancelEverything()"><b>CANCEL</b></button>
              </div>
  
              </form></p>
            </div></div>
      </div>
    </div>
        
        <!--<li class="list-group-item">-->      
            <div class="card scene_element scene_element--fadein" style="width: auto" id="beautifiedCard">
                <div class="card-body" style="padding-bottom: 1.75%;">
                    <!-- List all the courses associated with a user -->
                    <a href="{% url 'gradetracker:course_overview' course_id=course.id%}" class="mainLogo"> <h4 class="card-title"><b>{{ course.name }}
                      {% if course.Verified_Class %}
                       <span id="verification" class="rotunda" style="vertical-align: 0px;"></span>
                       {% endif %}
                       
                      {% if course.avgGrade.didGradeGoUp %}
                      <span style="float:right; color:rgb(0, 165, 27)">{{ course.avgGrade.gradePercentage }}%</span>
                      {% else %}
                      <span style="float:right; color:red">{{ course.avgGrade.gradePercentage }}%</span>
                      {% endif %}
                    </b></h4></a>


                  <p class="card-text" style="color:black; text-align: center;">

                   
                    <a onclick="document.getElementById('{{course.id}}CATEGORY').style.display='block';document.getElementById('overlay').style.display='block';">Add a Grade Category</a>
                    <a onclick="document.getElementById('{{course.id}}ASS').style.display='block';document.getElementById('overlay').style.display='block';">Add an assignment</a>
                    
                    <br />
                    

                  </p>


                  <a href="{% url 'gradetracker:delete_course' course_id=course.id%}" onclick="return confirm('Are you sure you want to delete this course?')" id="miniButtonRed"><span class="ti-trash"></span></a>
                  <a href="{% url 'gradetracker:duplicate_course' course_id=course.id%}" onclick="" id="miniButtons"><span class="ti-layers"></span></a>
                  <a href="{% url 'gradetracker:course_overview' course_id=course.id%}" onclick="" id="miniButtons" style="vertical-align: 1px; padding-right: 1%;"><span class="ti-new-window"></span></a>
                      
                  <label class="switch" style="vertical-align: 18.5px;margin-left: 1.25%;">
                    <input type="checkbox" onclick="calc('{{course.id}}','{{course.Include_In_GPA}}');" {% if course.Include_In_GPA %} checked{% endif %}>
                    <span class="slider round"></span>
                  </label><span style="font-size: 0.4em;vertical-align: 2.75px;">&nbsp;&nbsp;&nbsp;<b>INCLUDE IN GPA</b></span>

                  <span style="color:black; float: right;"><b>{{ course.number_Of_Credits|floatformat }} credits</b></span>

                </div>
              </div>
              
        <!--</li>-->
        
    {% endfor %}
            </div>
    
    </ul>

</div>

<!-- If the user has no courses -->
{% else %}
<div>
<p> <img src = "{% static 'gradetracker/addcourse.png' %}" width="25%" style="margin-top: 4%;margin-right:8%;margin-left:8%;float: right;"><br/>
    <h1 style="color: rgb(51, 51, 51);margin-top: 0%;margin-left: 6%;font-size: 5vw;line-height: 130%;font-family: Source Sans Pro;">Get started tracking your academic performance.</h1>
    <a href="{% url 'gradetracker:add' %}" class="addCourseButton" style="margin-left: 6%;margin-top:4%"><b>ADD COURSE&nbsp;&nbsp;<span class="ti-hand-point-right" style="vertical-align: -1px;"></span></b></a>

</p>
</div>

 

{% endif %}


    <script>
      function calc(coursePassedIn,shouldIncludeInGPA)
{
  $.ajax({
        type:'POST',
        url:'{% url "gradetracker:gpaInclude" %}',
        data:{
          csrfmiddlewaretoken:'{{ csrf_token }}',
          courseToAffect: coursePassedIn,
            
        },
        success:function(json){
            console.log(coursePassedIn)
        },
        error : function(xhr,errmsg,err) {
        console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
    }
    });
}


function cancelEverything() {
  var formsToDisable = document.getElementsByClassName("submitOrCancel");
  var x;
  for (x in formsToDisable) {
    formsToDisable[x].value=0;
  }
}

function enableEverything() {
  var formsToEnable = document.getElementsByClassName("submitOrCancel");
  var x;
  for (x in formsToEnable) {
    formsToEnable[x].value=1;
  }
}


        
            </script>
 
        

{% endblock content %}